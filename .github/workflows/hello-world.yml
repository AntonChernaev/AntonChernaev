# This is a basic workflow to help you get started with Actions
name: Hello World

# Controls when the action will run. 
on:
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: self-hosted

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v2

      # Runs a single command using the runners shell
      - name: Install Helm
        run: |
           ls -la 
           curl https://baltocdn.com/helm/signing.asc | sudo apt-key add -
           sudo apt-get install apt-transport-https --yes
           echo "deb https://baltocdn.com/helm/stable/debian/ all main" | sudo tee /etc/apt/sources.list.d/helm-stable-debian.list
           sudo apt-get update
           sudo apt-get install helm


      # Runs docker hello-world
      - name: Hello from Docker
        run: docker run hello-world
        
      # Setup kubeconfig
      - name: Hello from Docker
        run: | 
          sudo apt-get update
          sudo apt-get install -y apt-transport-https ca-certificates curl
          sudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg
          echo "deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-xenial main" | sudo tee /etc/apt/sources.list.d/kubernetes.list
          sudo apt-get update
          sudo apt-get install -y kubectl
          cat <<EOF > kubeconfig
          apiVersion: v1
          clusters:
          - cluster:
              certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvakNDQWVhZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeU1EUXlOREV3TlRneU5Gb1hEVE15TURReU1URXdOVGd5TkZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTTBjClA1bEZES0hqRUZsSGMxY0czdE8yV0RGL3hsM1dseEhxQXoxME5RUnBad1VDMGI2QTFrWEt5WnpEM3duWFcrTUQKU0dvMUV3N05rSnhsNlRKYnFjRVVPNFo0aldUN1YrSkNFLzQvN0RSNE9IU2tHd25BbWpXUU1WSXdtQVQzbFdJRgpOWHUvZ1M5dldkbWFKbkMzZGNhV2xScXJNbmNGdVFGdFBmYnlHMzFLZGFCM3BZeFVycFdNNTl2VXBmbXRnMWZECkd0MVZ6QVMrVHhxQjNMaWpUNDVoUWhqNnE0d2l4YXgrbFlmWHdQNFZRMzRWSThvZDduU3BQRSt0b2hXeURWNkkKRXp0a2dMTDc1Q2VIc3A3YTFNaTNpVW9rUjRwV3VEWCtHZ3N3YlFDN1JZUnMxaEhzaFpPOXZINERJYTlSOWh0YQprRU5NbkcwVjlhL2JUcGhNQWNNQ0F3RUFBYU5aTUZjd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZMcFhCY1BEQU91dE9WZTA3UjMyMXpFNm4rNGVNQlVHQTFVZEVRUU8KTUF5Q0NtdDFZbVZ5Ym1WMFpYTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBQXFnMGZya3U5NFRVWXA2Nnk1SwpjR1JLa1ZOZTN2Wnh0NXlNK29ZK3o3Zm44RGxtMEk5a09mYUpYSmo2S3hxR3F6M2o1bWVtL2ZrYy9qTW1iYlJICk4yNzRKa0NzUmU2ektKaHRuRGsxZWJ4eXlMVllyenFEb2IrM1BqbTZrb1QxR2ZPMWR2YU1SU09INnRKcjRvY1kKaVZrdTJSL3ZyUWtQa085a0lGWG1tcHQwMDhLWk9lcUtjekFMNXdzUDh6dGZ3WFlNTmt1ckp3TzRCNmZuOG9DVQpXbVFRQU92ZEh6Ri8vYWZTQ2s0clM0aTZCcjhnWGNJa0k0Y3JuaHN1em5reWIvV0RtWnRMWlZKM28wSldIRENhCi9BTUR6RDBhR3FTR28rUkdObE9ValdnVVY2MGc4STBaYzJaOTNjWitVMzZHdUhTclhyMmRzQiticDN0SHF1dmoKMGxZPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
              server: https://kubernetes.default.svc
          name: kind-kind
          contexts:
          - context:
              cluster: kind-kind
              user: kind-kind
            name: kind-kind
          current-context: kind-kind
          kind: Config
          preferences: {}
          users:
          - name: kind-kind
            user:
              client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJVENDQWdtZ0F3SUJBZ0lJTnNsTElHZ0VtL3N3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TWpBME1qUXhNRFU0TWpSYUZ3MHlNekEwTWpReE1EVTRNamRhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTMzRk54NVcvSmdKRUZ6VXoKeTg2ZzloMFJ3dWxhUkFKTW5EY1ZTdE82dDhMOTR3WEVDc281aUJQUGxoUjd1aDN4THpEbDVkTW1BY1JwREo2aQo4eWlxQnRnVEVpaWVzaTBnQ3ZtRi8wYlM1eXF4akZ6OTNiM25NRE8zbmIxdzA0eWtvMWFXRjhXWkNGTFJKUlUrCmpySWRCVllPaFNrUXYwNi9QbFpxU2FSTDFDSU52ZXNzNndoYnRPWHFoZEpvdjNXN2owdmplczc1dmRkS3g1TUwKdTZtRUhuakRBV0NrbFd6UEFrNXVVWHExdGpWTHRXbGllSU4rQ2c1V3luaXVhdSsveldmaVNPUytXS1BTbkFGWApBMU1vMEZEWCtjTzJjOWVhWElnK2VEamdXYWtTRUFVazg4bm5PUHQ2S0tEMk9pTnc4YzAxZnRzOTUxemtPSElFCk5yOWU3d0lEQVFBQm8xWXdWREFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RBWURWUjBUQVFIL0JBSXdBREFmQmdOVkhTTUVHREFXZ0JTNlZ3WER3d0RyclRsWHRPMGQ5dGN4T3AvdQpIakFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBSmZTNnFEQ0gyMUtRd0V4dzF0K2pMQXQ1SDRFSkpPbi94N0hMCjR6NnhiK0RHWjBUQkhabEVDbUMxeWVkWG9jaXFrV29nd0o0ekJIQVViK2FpTXhtU3oyYndFK0tUZkJ4MHhyVk8KYzhmVFc5SFhodmFxdVJmU2JXblBEaWN3eUdmdWdIWG5xT1Z5YWJjZnRjUkNwS2V6ejJ6cW5LLy9oRlRqaForVwpaa1AreSthcEhQMnhkaWZKalZQZUdRbzluTGxtWUR0b3FmM3ZGNUNvQ05NdE9qNDQ3VU5ZZHhJd09GNGpRY291CmE4RVcwSlkySkFCcUtlZXBTQW1XUXYrMkgwVHVtMDVDc0lYR29PWFJZN2ZBSHNDNko0ZTZ0aEt3cE5WVUNJSngKbk9TWiszYU1VWHpEZ201dFhsMU1oQjVGVzJWSGRFZFVZbWhEekE3RUhyMjhtdXBLeWc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
              client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBMzNGTng1Vy9KZ0pFRnpVenk4Nmc5aDBSd3VsYVJBSk1uRGNWU3RPNnQ4TDk0d1hFCkNzbzVpQlBQbGhSN3VoM3hMekRsNWRNbUFjUnBESjZpOHlpcUJ0Z1RFaWllc2kwZ0N2bUYvMGJTNXlxeGpGejkKM2Izbk1ETzNuYjF3MDR5a28xYVdGOFdaQ0ZMUkpSVStqcklkQlZZT2hTa1F2MDYvUGxacVNhUkwxQ0lOdmVzcwo2d2hidE9YcWhkSm92M1c3ajB2amVzNzV2ZGRLeDVNTHU2bUVIbmpEQVdDa2xXelBBazV1VVhxMXRqVkx0V2xpCmVJTitDZzVXeW5pdWF1Ky96V2ZpU09TK1dLUFNuQUZYQTFNbzBGRFgrY08yYzllYVhJZytlRGpnV2FrU0VBVWsKODhubk9QdDZLS0QyT2lOdzhjMDFmdHM5NTF6a09ISUVOcjllN3dJREFRQUJBb0lCQUdYMyt4cmVCOEY4dno0bwpGVjhwQ09QSUdGYnV6emJDSmR3VWR5OFN1TjhycVZsMVJDWDRhNURpR1pYUCt6YlFlMFNoK0FpTjk0Wk83L0hHClkyNjhXL3VMbUFodGFSNis0U1NoQXJtZ3hKYWlNU3h4TTVtQ0ZJTTIxdEN4cDAram0yNi9FUGdBUVBvL2NScVAKTzJFN2YycnovdVJkL1RxUTRVMjllZnZwY29GM3ZwdHJmZkYzcEYrY2tQQnhCcnhjVytWVk1wRFBseitVck9ObQp6Z1pXUFp3V09OV0NBbTY0bVhteUtrUzIxc0RxV2poRFUzeEJaem1Ra2x2VHlXYWg2djdmaWRlY29TRWhGcUV0Cm9hR28zcFE5S0ZuS2J6em9SaWQ5SjBBVHFNbEQvbFV4dFpJNnFFZHNWVWlHTjN3ME80aHBtc2pkVEYyTFBmUW4KSmZsTFF1RUNnWUVBOU04M3l5OGlUUVlsUTZNYWUyMHpQdDUvd2RZNUlhUjdyRWlGa2d5STZOdFRTNk01UXFrOQplR2M1R3Q5TS9EdHMrMWFTUjlIcFFLeEpPai9COHBmTmovcUtIekpQU2JDSFIvQjdsQXNxV3h1ZEs1YzVZMmpsCldmZ2NKamxqRzlrLy9KSldZU1FMVGVPMEhmNHA3WUQ3NytMaytIQWtMcVpHcEc4M0l1YTBBTHNDZ1lFQTZhZ00KajVycDRGU1BqS2FDdWt0WjhDbDZaOGV5QlpNY0srWmk5TXVjZy9YV2I3TmlDSVVpeFdwbVJBT2RFbmVXdm9icgppK291YlhyZjBXdG16NWdDZ0o2UUNQRVNXY3g4NC9HMWR6MkJQVFhyYUlpVzZsQTI4UkJvUlZPcFNOdnNRU0o0CnJjdjU4bDZFa25YbGM5NVc3UzFuWDA4VkdneWFXRTVPRWRNWklWMENnWUVBMnJXK1RPSWhMTnNPczZ5bDNoc2oKSzBtd3JjWHJhS2tBYkZ5bUtHTFdkZUpzT2lqcTRTazk1N0dnak9kdWFmSFZYWDVzVlltdGI3Lzc4L1ErRzdPUApUTkF5VWNpcW1WVUNwenlyeXdsbW45cTl3ZEhxeld0TGErT0Rrb3EyaG96QzQ2MEJTdXZleFlsbXcxenNyR2tOCnE3VHpoeGo0Mmt4bTFFVWY1eWhoTEQwQ2dZRUFqVFNuMHFsMktjSXd0bmx5aTQ4NkhTK1Q3OS81TC9GRmx5bzIKSjJaZGdrb3hlM1BYRFBzWWxtSEV4OW0vTlFmY3ErdnhzYTZtdkRjRHlCVzJIa0xwVUQyRElrUStLTkt4cnpmRgp5UGY4Z0xkek9zdEJHUDI5RmxZcURhdVBwSjV6MnJFd2FTZmFONlR6VFdlK2NSV3ZSc3FuckN1b3Z3TmF5MzhYCkl5S0dEMmtDZ1lCVHVOYWp0bmJ4MVNoeTM5Z0JrMmpqV2tVVmxFR3QzVW5BZXlGWnJtc3FRK1JpcllNNlgwS2sKdlpDa3VwZFBlVk0vckIyVXRuaXRXbHlzVXhKb1R2WXM5aGdqZE1OdXF2UnJ4c1hjV1F0ZEFZS0cza1JaMmxMZApXaHYrTFlJcEMxcy9NSDRBUlJiV0FmMldhaXFuVm1wWTdMVTdJanlMUTNhdXdEazB4M0tKSUE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
          EOF
          kubectl get namespaces --kubeconfig kubeconfig
